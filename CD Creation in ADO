trigger: none
pr: none
 
pool: CloudOps-AM-EastUS-Linux
resources:
  repositories:
    - repository: elc-sre
      type: git
      name: Site Reliability Engineering/elc-sre
    - repository: sre-helm-charts
      type: github
      name: elc-digital/sre-helm-charts
      ref: gh-pages
      endpoint: elc-digital
 
variables:
  - template: templates/vars.yml@elc-sre
  - group: sre-shared
 
steps:
  - checkout: sre-helm-charts
  - checkout: self
  - task: HelmInstaller@0
    inputs:
       helmVersion: "2.14.1"
       installKubectl: true
       
  - task: HelmDeploy@0
    inputs:
      connectionType: 'Kubernetes Service Connection'
      kubernetesServiceConnection: 'AKS-AM-EastUS-Dev-LFW-admin'
      namespace: 'lfwd'
      command: 'upgrade'
      chartType: 'FilePath'
      chartPath: 'sre-helm-charts/applications-0.1.7.tgz'
      releaseName: 'lfw-clientdev'
      valueFile: 'LFW-2.0/dev/helm/client-values.yaml'
      # arguments: '--timeout 30m --set podTemplate.containers[0].image.tag=$(DOCKER_CUSTOM_TAG)'
      # condition: eq(variables.helmDeploy, true)
